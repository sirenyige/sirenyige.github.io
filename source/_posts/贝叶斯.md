---
title: 贝叶斯
date: 2020-04-06 16:57:30
categories:
- 机器学习
tags:
- 概率论
---

# 贝叶斯公式

先验概率，后验概率，条件概率，贝叶斯，极大似然

<!-- more -->

## 一、条件概率

### 1、条件概率

条件概率涉及两个事件A与B，在事件B已发生的条件下，事件A再发生的概率为条件概率，记为P(A|B)。
设A与B是基本空间Ω中的两个事件，且P(B)>0，在事件B已发生的条件下，事件A的条件概率P(A|B)定义为
$$
P(A | B)=\frac{P(A B)}{P(B)}
$$

### 2、分割

把基本空间Ω分为n个事件B~1~，B~2~，…，B~n~，假如
(1) $P\left(B_{i}\right)>0, i=1,2, \cdots, n$
(2)B~1~，B~2~，…，B~n~互不相容
(3)$\bigcup_{i=1}^{n} B_{i}=\Omega$
则称时间组B~1~，B~2~，…，B~n~为基本空间Ω的一个分割。

### 3、全概率公式

设B~1~，B~2~，…，B~n~是基本空间Ω的一个分割，则对Ω中任一事件A，有
$$
P(A)=\sum_{i=1}^{n} P\left(A | B_{i}\right) P\left(B_{i}\right)
$$

### 4、贝叶斯公式

设B~1~，B~2~，…，B~n~是基本空间Ω的一个分割，A是Ω中的一个事件，则在A给定的下，事件B~k~的条件概率为
$$
P\left(B_{k} | A\right)=\frac{P\left(A | B_{k}\right) P\left(B_{k}\right)}{\sum_{i=1}^{n} P\left(A | B_{i}\right) P\left(B_{i}\right)}, \quad k=1,2, \cdots, n
$$


## 二、先验概率、后验概率与似然函数

### 1、先验概率

先验概率是指根据以往经验和分析得到的概率，它往往作为“由因求果”问题中的“因”出现。

> - 利用过去历史资料计算得到的先验概率，称为客观先验概率；
> - 当历史资料无从取得或资料不完全时，凭人们的主观经验来判断而得到的先验概率，称为主观先验概率。

### 2、后验概率

在贝叶斯统计中，后验概率（Posterior probability）是在考虑和给出相关证据或数据后所得到的条件概率，表示在事情已经发生的条件下，该事发生原因是有某个因素引起的可能性的大小。

> 
>
> 一口袋里有3只红球、2只白球，采用不放回方式摸取，求：
>
> ⑴ 第一次摸到红球（记作A）的概率；
>
> ⑵ 第二次摸到红球（记作B）的概率；
>
> ⑶ 已知第二次摸到了红球，求第一次摸到的是红球的概率。
>
> 解：
>
> (1) P(A) = 3/5     先验概率
>
> (2) P(B) = P(A)P(B|A)+P(A')P(B|A') = 3/5\*2/4+2/5\*3/4=3/5
>
> (3) P(A|B) =  P(A)P(B|A)/P(B)=1/2   后验概率

### 3、似然函数

似然函数是一种关于统计模型中的参数的函数，表示模型参数中的似然性。

- 概率，用于在已知一些参数的情况下，预测接下来在观测上所得到的结果
- 似然性，则是用于在已知某些观测所得到的结果时，对有关事物之性质的参数进行估值。

已知有事件A发生，运用似然函数$ {L} (B\mid A) $，我们估计参数B的可能性。形式上，似然函数也是一种条件概率函数，但我们关注的变量改变了：
$$
b \mapsto P(A | B=b)
$$
一个似然函数乘以一个正的常数之后仍然是似然函数。对所有$ \alpha >0 $，都可以有似然函数：
$$
L(b | A)=\alpha P(A | B=b)
$$

> 假设硬币投出时会有$ p_{H}$的概率正面朝上，而有$ 1-p_{H}$的概率反面朝上。这时，通过观察已发生的两次投掷，条件概率可以改写成似然函数：
> $$
> L\left(p_{H} | \mathrm{HH}\right)=P\left(\mathrm{HH} | p_{H}=0.5\right)=0.25
> $$
> 也就是说，对于取定的似然函数，在观测到两次投掷都是正面朝上时，$ p_{H}=0.5$的似然性是0.25。
>
> 如果考虑$ p_{H}=0.6$，那么似然函数的值也会改变，
> $$
> L\left(p_{H} | \mathrm{HH}\right)=P\left(\mathrm{HH} | p_{H}=0.6\right)=0.36
> $$
> 这说明，如果参数$ p_{H}$的取值变成0.6的话，结果观测到连续两次正面朝上的概率要比假设$ p_{H}=0.5$时更大。也就是说，参数$ p_{H}$297取成0.6要比取成0.5更有说服力，更为“合理”。
>
> 1、在这个例子中，似然函数实际上等于：
> $$
> L(\theta | \mathrm{HH})=P\left(\mathrm{HH} | p_{H}=\theta\right)=\theta^{2}, 0 \leq p_{H} \leq 1
> $$
> 如果取$ p_{H}=1$，那么似然函数达到最大值1。也就是说，当连续观测到两次正面朝上时，假设硬币投掷时正面朝上的概率为1是最合理的。
>
> 2、类似地，如果观测到的是三次投掷硬币，头两次正面朝上，第三次反面朝上，那么似然函数将会是：
> $$
> L(\theta | \mathrm{HHT})=P\left(\mathrm{HHT} | p_{H}=\theta\right)=\theta^{2}(1-\theta), \text {其中T表示反面朝上}, 0 \leq p_{H} \leq 1
> $$
> 这时候，似然函数的最大值将会在$ p_{H}={\frac {2}{3}}$的时候取到。也就是说，当观测到三次投掷中前两次正面朝上而后一次反面朝上时，估计硬币投掷时正面朝上的概率$p_{H}={\frac {2}{3}}$是最合理的。

